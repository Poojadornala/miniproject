<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ANDHRA PRADESH</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
  <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  <script>
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({ pageLanguage: 'en' }, 'google_translate_element');
    }
  </script>
  <style>
    #map {
      height: 400px;
      width: 100%;
      margin-bottom: 20px;
    }
    nav ul {
      list-style: none;
      padding: 0;
      display: flex;
      justify-content: center;
      gap: 1rem;
      background-color: #f0f0f0;
    }
    nav ul li {
      display: inline;
    }
    nav ul li a {
      text-decoration: none;
      color: #333;
    }
    .center {
      text-align: center;
    }
    .button {
      background-color: #007BFF;
      color: white;
      padding: 8px 16px;
      text-decoration: none;
      border-radius: 5px;
    }
    .button:hover {
      background-color: #0056b3;
    }
    table {
      margin: 0 auto;
      border-collapse: collapse;
    }
    th, td {
      padding: 8px 12px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h4 align="center">ANDHRA PRADESH</h4>

  <header>
  <div class="menu-btn"></div>
    <div class="navigation">
      <div class="navigation-items">
    <a href="#about">About</a>
    <a href="#image">Image</a>
    <a href="#location">Location</a>
    <a href="#accomodation">Accommodation</a>
    <a href="#slokam">Bhagavad Gita</a>
    <a href="krishna1.html">Back</a>
    </div>
    </div>
    </header>

 <div id="google_translate_element" style="text-align: center; margin: 20px;"></div>
<div id="openChatbot" style="
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 60px;
  height: 60px;
  background: #3d4b4a;
  border-radius: 50%;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 9999;">
  <img src="https://png.pngtree.com/png-vector/20220611/ourmid/pngtree-chatbot-icon-chat-bot-robot-png-image_4841963.png" alt="Chat" width="70" height="50" />
</div>

<!-- Chatbot Iframe (Initially Hidden) -->
<div id="chatbotWidget" style="
  display: none;
  position: fixed;
  bottom: 90px;
  right: 20px;
  width: 360px;
  height: 500px;
  border: none;
  z-index: 9998;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  border-radius: 16px;
  overflow: hidden;
">
  <iframe src="chatbot.html" style="width:100%; height:100%; border:0; border-radius: 16px;"></iframe>
</div>
  <div class="container">

 

    <section id="about">
      <h1 align="center">Panduranga Swamy Temple – Machilipatnam</h1>
      <p> Panduranga Swamy Temple is a famous temple in Chilakalapudi, Machilipatnam, Krishna District, Andhra Pradesh. It was built in 1929 by Sri Bhakta Narasimham. The temple has spiritual significance for the locals and closely resembles the Pandharpur temple in Maharashtra.</p>
    </section>

    <h1 align="center">Temple</h1>
    <center><section id="Image"><img src="andhra.jpg" alt="Panduranga Temple" /></section></center>

    <h2 align="center">History</h2>
    <section id="History">
      <p>This temple was constructed in 1929 by Sri Bhakta Narasimham and dedicated to Lord Panduranga Vithal. It is considered the second most famous Panduranga temple in India. Devotees take a holy dip at Manginapudi seashore during Kartika Purnima. The temple also features a Sahasralinga mandapam and over 100 other shrines.</p>
    </section>

    <h2 align="center">Festivals</h2>
    <section id="festivals">
      <p>Karthika Masam, Gowri Pooja</p>
    </section>

    <h2 align="center">Location</h2>
    <section id="location">
      <table>
        <tr><th>Location</th><td>Chilakalapudi, Machilipatnam</td></tr>
        <tr><th>State</th><td>Andhra Pradesh</td></tr>
        <tr><th>Country</th><td>India</td></tr>
        <tr><th>Deity</th><td>Panduranga Swamy</td></tr>
      </table>
    </section>

    <h2 align="center">Accommodation</h2>
    <section id="accommodation">
      <p class="center"><a class="button" href="https://www.booking.com" target="_blank" rel="noopener">Click here to book a room</a></p>
    </section>

    <h2 class="center">Bhagavad Gita Slokam</h2>
    <section id="slokam">
      <h2 class="center">Chapter 9, Verse 24</h2>
      <p class="center">अहं हि सर्वयज्ञानां भोक्ता च प्रभुरेव च ||<br>न तु मामभिजानन्ति तत्त्वेनातश्च्यवन्ति ते || 24||</p>
      <p class="center"><br>ahaṁ hi sarva-yajñānāṁ bhoktā cha prabhureva cha<br>na tu mām abhijānanti tattvenātaś chyavanti te</p>
      <center>
        <audio controls>
          <source src="chapter9verse24.mp3" />
          Your browser does not support the audio element.
        </audio>
      </center>
      <h3 class="center">Translation</h3>
      <p class="center">I am the enjoyer and the only Lord of all sacrifices. But those who fail to realize My divine nature must be reborn.</p>
    </section>

    <h2 align="center">Route to Panduranga Swamy Temple</h2>
    <div id="map"></div>

    <section id="reviews" class="center">
  <h2>Reviews</h2>
  <div id="review-form">
    <textarea id="review-text" rows="4" cols="50" placeholder="Write your review..." required></textarea><br>
    <button id="submit-review">Submit Review</button>
  </div>
  <div id="review-list"></div>
</section>
<div id="chatbot-window" style="position: fixed; bottom: 80px; right: 20px; width: 300px; max-height: 400px; background: white; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: none; flex-direction: column; z-index: 1000;">
  <div style="background: #6b4fbb; color: white; padding: 10px; border-radius: 10px 10px 0 0;">Ask KrishnaBot</div>
  <div id="chatlog" style="padding: 10px; overflow-y: auto; flex-grow: 1; max-height: 300px;"></div>
  <div style="display: flex; border-top: 1px solid #ccc;">
    <input id="chat-input" type="text" placeholder="Ask about this site..." style="flex: 1; border: none; padding: 10px;">
    <button onclick="sendChat()" style="background: #6b4fbb; color: white; border: none; padding: 10px;">Send</button>
  </div>
</div>
  </div>

  <!-- Leaflet JS & Routing plugin -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.min.js"></script>

  <script>
    const templeCoords = [16.196, 81.1587];

    const map = L.map('map').setView(templeCoords, 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    L.marker(templeCoords).addTo(map).bindPopup('Panduranga Swamy Temple').openPopup();

    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function (position) {
        const userCoords = [position.coords.latitude, position.coords.longitude];

        L.marker(userCoords).addTo(map).bindPopup("You are here").openPopup();

        const control = L.Routing.control({
          waypoints: [
            L.latLng(userCoords),
            L.latLng(templeCoords)
          ],
          routeWhileDragging: false,
          createMarker: function() { return null; },
          show: false,
          addWaypoints: false,
          draggableWaypoints: false,
          fitSelectedRoutes: true,
          showAlternatives: false,
        }).addTo(map);

        control.on('routesfound', function(e) {
          const summary = e.routes[0].summary;
          const distanceInKm = (summary.totalDistance / 1000).toFixed(2);
          const timeInMin = Math.round(summary.totalTime / 60);

          L.popup()
            .setLatLng(templeCoords)
            .setContent(`Distance: ${distanceInKm} km<br>Estimated time: ${timeInMin} minutes`)
            .openOn(map);

          if (control._routes?.[0]?.line) {
            control._routes[0].line.setStyle({
              color: 'blue',
              weight: 5,
              opacity: 0.8
            });
          }
        });

      }, function () {
        alert("Location permission denied.");
      });
    } else {
      alert("Geolocation is not supported by your browser.");
    }
  </script>
  <script type="module">
import { auth, db } from './firebase.js';
import {
  collection,
  addDoc,
  getDocs,
  query,
  where,
  deleteDoc,
  updateDoc,
  doc
} from "https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js";

const templeId = "panduranga swamy";
const reviewList = document.getElementById('review-list');
const reviewInput = document.getElementById('review-text');
const submitBtn = document.getElementById('submit-review');
let currentUser;

auth.onAuthStateChanged(user => {
  currentUser = user;
  if (user) {
    console.log("✅ Logged in as:", user.email);
    loadReviews();
  } else {
    alert("⚠️ Please log in to view/post reviews.");
  }
});

async function loadReviews() {
  const q = query(collection(db, "reviews"), where("temple", "==", templeId));
  const snapshot = await getDocs(q);
  reviewList.innerHTML = "";
  snapshot.forEach(docSnap => {
    const r = docSnap.data();
    const reviewHTML = `
      <div style="border:1px solid #ccc; padding:10px; margin:10px 0;">
        <strong>${r.name}</strong><br>
        <p>${r.review}</p>
        ${r.uid === currentUser?.uid ? `
          <button onclick="editReview('${docSnap.id}', \`${r.review.replace(/`/g, "\\`")}\`)">Edit</button>
          <button onclick="deleteReview('${docSnap.id}')">Delete</button>
        ` : ''}
      </div>
    `;
    reviewList.insertAdjacentHTML('beforeend', reviewHTML);
  });
}

submitBtn.addEventListener('click', async () => {
  const text = reviewInput.value.trim();
  if (!text || !currentUser) return alert("Please write a review and log in.");
  await addDoc(collection(db, "reviews"), {
    temple: templeId,
    uid: currentUser.uid,
    name: currentUser.displayName || currentUser.email,
    review: text,
    createdAt: Date.now()
  });
  reviewInput.value = '';
  loadReviews();
});

window.editReview = async (id, oldText) => {
  const newText = prompt("Edit your review:", oldText);
  if (!newText) return;
  await updateDoc(doc(db, "reviews", id), {
    review: newText
  });
  loadReviews();
};

window.deleteReview = async (id) => {
  if (!confirm("Delete this review?")) return;
  await deleteDoc(doc(db, "reviews", id));
  loadReviews();
};
</script>

</body>
</html>